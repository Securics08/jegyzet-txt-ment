<!DOCTYPE html>
<html lang="hu">
<head>
<meta charset="UTF-8">
<title>V√©gtelen Jegyzet PRO - ZIP Ment√©s</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Monoton&family=Pinyon+Script&family=Nabla&family=Bungee+Shade&family=Ewert&family=Vast+Shadow&family=Creepster&family=Lobster&family=Righteous&family=Faster+One&family=Special+Elite&family=Orbitron&family=Pacifico&family=Press+Start+2P&family=Permanent+Marker&family=Sacramento&family=Silkscreen&family=Codystar&family=Megrim&family=Fredericka+the+Great&family=UnifrakturMaguntia&family=Wallpoet&family=Syncopate&family=Fascinate+Inline&family=Nosifer&family=Rubik+Glitch&family=Bangers&family=Alumni+Sans+Inline+One&family=Iceberg&family=Glass+Antiqua&family=Kranky&family=Great+Vibes&family=Bruno+Ace+SC&family=VT323&family=Montserrat&family=Nunito&family=Oswald&family=Playfair+Display&family=Spectral&family=Ultra&family=Varela+Round&family=Alegreya&family=Roboto+Serif&family=Roboto+Mono&display=swap" rel="stylesheet">
<style>
:root{--bg:#0e0e0e;--panel:#1a1a1a;--text:#eee;--border:#444;}
.light{--bg:#f5f5f5;--panel:#e0e0e0;--text:#222;--border:#bbb;}
body{margin:0;background:var(--bg);color:var(--text);font-family:Consolas,monospace;}
#topbar{display:flex;flex-wrap:wrap;gap:6px;padding:10px;background:var(--panel);border-bottom:1px solid var(--border);}
button,select,input{background:var(--bg);color:var(--text);border:1px solid var(--border);padding:6px 10px;border-radius:4px;}
textarea{width:100vw;height:calc(100vh - 140px);background:var(--bg);color:var(--text);border:none;padding:20px;box-sizing:border-box;resize:none;line-height:1.6;}
#pdf-helper{position:absolute;left:-9999px;width:800px;padding:40px;white-space:pre-wrap;}
#search{width:130px;}
</style>
</head>
<body>

<div id="topbar">
<select id="notes"></select>
<button onclick="newNote()">+ √öj</button>
<select id="fontFamily" onchange="changeFont()">
<!-- ide j√∂n a 50+ bet≈±t√≠pus sz√≠nesen, mint kor√°bban -->
<option value="Consolas" style="color:#ffffff;">Consolas (Alap)</option>
<option value="Montserrat" style="color:#00ffcc;font-family:'Montserrat';">Montserrat</option>
<!-- ... mind a t√∂bbi bet≈±t√≠pus ... -->
</select>

<input type="number" id="fontSize" value="14" min="8" max="100" oninput="changeSize()">
<button onclick="insertDate()">üïí D√°tum</button>
<button onclick="toggleDark()">üåì S√∂t√©t</button>
<button onclick="downloadTxt()">‚¨á TXT</button>
<button onclick="importTxt()">üìÇ Import</button>
<input type="file" id="fileInput" accept=".txt" style="display:none">
<button onclick="downloadPDF()">üìÑ PDF</button>
<button onclick="downloadAllZip()">üì¶ Minden ZIP</button>
<button onclick="deleteCurrent()">üóë T√∂rl√©s</button>
<button onclick="deleteAll()">‚ö†Ô∏è Reset</button>
<input id="search" placeholder="Keres√©s..." oninput="searchText()">
</div>

<textarea id="editor"></textarea>
<div id="pdf-helper"></div>

<script>
let notes=JSON.parse(localStorage.getItem("MY_NOTES"))||{"√údv√∂zl≈ë":"Minden bet≈±t√≠pus visszaker√ºlt a list√°ba!"};
let current=Object.keys(notes)[0];
const editor=document.getElementById("editor");
const select=document.getElementById("notes");
const fileInput=document.getElementById("fileInput");
const pdfHelper=document.getElementById("pdf-helper");
let dark=true;

function refresh(){select.innerHTML="";for(let n in notes){let o=document.createElement("option");o.value=n;o.textContent=n;select.appendChild(o);}select.value=current; editor.value=notes[current];}
refresh();

editor.addEventListener("input",save);
select.addEventListener("change",()=>{current=select.value; editor.value=notes[current]; save();});

function save(){notes[current]=editor.value; localStorage.setItem("MY_NOTES",JSON.stringify(notes));}
function newNote(){let n=prompt("Jegyzet neve:"); if(!n||notes[n])return; notes[n]=""; current=n; refresh(); save();}
function deleteCurrent(){if(confirm("Biztosan t√∂rl√∂d ezt a jegyzetet? Ez nem visszavonhat√≥!")){delete notes[current]; current=Object.keys(notes)[0]||"Alap"; refresh(); save();}}
function deleteAll(){if(confirm("MINDEN jegyzet t√∂rl≈ëdik a mem√≥ri√°b√≥l! Biztos?")){localStorage.clear(); location.reload();}}
function insertDate(){const d=new Date().toLocaleString(); editor.setRangeText("\n["+d+"]\n",editor.selectionStart,editor.selectionEnd,"end"); save();}
function toggleDark(){dark=!dark; document.body.classList.toggle("light",!dark);}
function changeFont(){editor.style.fontFamily=document.getElementById("fontFamily").value;}
function changeSize(){editor.style.fontSize=document.getElementById("fontSize").value+"px";}

function downloadTxt(){const a=document.createElement("a"); a.href=URL.createObjectURL(new Blob([editor.value],{type:"text/plain"})); a.download=current+".txt"; a.click();}
function importTxt(){fileInput.click(); fileInput.onchange=function(){const f=fileInput.files[0]; if(!f)return; const r=new FileReader(); r.onload=e=>{let n=f.name.replace(/\.txt$/i,""); let base=n,c=1; while(notes[n]){n=base+"_"+c;c++;} notes[n]=e.target.result; current=n; refresh(); save();}; r.readAsText(f,"UTF-8");};}
function downloadPDF(){pdfHelper.style.fontFamily=editor.style.fontFamily; pdfHelper.style.fontSize=editor.style.fontSize; pdfHelper.style.background=dark?"#0e0e0e":"#f5f5f5"; pdfHelper.style.color=dark?"#eee":"#222"; pdfHelper.innerText=editor.value; html2canvas(pdfHelper,{scale:2}).then(c=>{const img=c.toDataURL("image/png"); const pdf=new jspdf.jsPDF(); const w=pdf.internal.pageSize.getWidth(); const h=(c.height*w)/c.width; pdf.addImage(img,"PNG",0,0,w,h); pdf.save(current+".pdf");});}
function searchText(){let q=document.getElementById("search").value.toLowerCase(); let pos=editor.value.toLowerCase().indexOf(q); if(pos!==-1){editor.focus(); editor.setSelectionRange(pos,pos+q.length);}}

function downloadAllZip(){
    if(!confirm("Az √∂sszes jegyzet egy ZIP f√°jlba ker√ºl √©s let√∂lt≈ëdik. Folytatod?")) return;
    const zip=new JSZip();
    for(let n in notes){
        zip.file(n+".txt", notes[n]);
    }
    zip.generateAsync({type:"blob"}).then(function(content){
        const a=document.createElement("a");
        a.href=URL.createObjectURL(content);
        a.download="All_Notes.zip";
        a.click();
    });
}
</script>
</body>
</html>
